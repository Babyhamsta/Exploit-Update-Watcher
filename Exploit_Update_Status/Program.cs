using System;
using System.Media;
using System.Net;
using System.Threading;

namespace Exploit_Update_Status
{
    class Program
    {

        public static WebClient client = new WebClient(); // no need to create a new client every loop

        // Lord forgive me for this sloppy coding c;
        // HamstaGang was here, hope you enjoy!
        
        static void Main(string[] args)
        {
            Console.Title = "[HamstaGang] | Exploit Update Status";
            MainMenu();
        }

        private static bool MainMenu()
        {
            Console.Clear();
            Console.WriteLine("Please choose an exploit to watch for updates on:");
            Console.WriteLine("1) Synapse");
            Console.WriteLine("2) Script-Ware");
            Console.WriteLine("3) KRNL");
            Console.WriteLine("4) Temple (Not implemented yet)");
            Console.WriteLine("5) All of the above");
            Console.Write("\r\nPlease select an option: ");

            switch (Console.ReadLine())
            {
                case "1":
                    Synapse_Watch();
                    return true;
                case "2":
                    Script_Watch();
                    return true;
                case "3":
                    KRNL_Watch();
                    return true;
                case "4":
                    //Temple_Watch();
                    return true;
                case "5":
                    ALL_Watch();
                    return true;
                default:
                    return true;
            }
        }

        private static void Loop_Beep()
        {
            while (true)
            {
                SystemSounds.Beep.Play();
                Thread.Sleep(1000);
            }
        }

        private static void Synapse_Watch()
        {
            string Curr_Version = "";
            string First_Check_Version = "";

            Console.Clear();

            string VersionReturn = client.DownloadString("https://synapse.to/whitelist/version");

            Console.WriteLine("Current version: ");
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(VersionReturn);
            Console.ResetColor();

            First_Check_Version = VersionReturn;
            Curr_Version = VersionReturn;

            Console.WriteLine("\nChecking for updates every 30 seconds..");
            while (Curr_Version == First_Check_Version)
            {
                Console.Title = "[HamstaGang] | Exploit Update Status | Last check: " + DateTime.Now.ToString("h:mm:ss tt");
                Curr_Version = client.DownloadString("https://synapse.to/whitelist/version");
                Thread.Sleep(30000);
            }

            Console.Clear();
            Console.ForegroundColor = ConsoleColor.Green;
            Console.WriteLine("Exploit has updated! Feel free to now use it!");
            Loop_Beep();
            Console.ReadKey(true);
        }

        private static void Script_Watch()
        {
            string Curr_Version = "";
            string First_Check_Version = "";

            Console.Clear();

            string VersionReturn = client.DownloadString("https://script-ware.com/api/version/core");

            Console.WriteLine("Current version: ");
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(VersionReturn);
            Console.ResetColor();

            First_Check_Version = VersionReturn;
            Curr_Version = VersionReturn;

            Console.WriteLine("\nChecking for updates every 30 seconds..");
            while (Curr_Version == First_Check_Version)
            {
                Console.Title = "[HamstaGang] | Exploit Update Status | Last check: " + DateTime.Now.ToString("h:mm:ss tt");
                Curr_Version = client.DownloadString("https://script-ware.com/api/version/core");
                Thread.Sleep(30000);
            }

            Console.Clear();
            Console.ForegroundColor = ConsoleColor.Green;
            Console.WriteLine("Exploit has updated! Feel free to now use it!");
            Loop_Beep();
            Console.ReadKey(true);
        }

        private static void KRNL_Watch()
        {
            string Curr_Version = "";
            string First_Check_Version = "";

            Console.Clear();

            string VersionReturn = client.DownloadString("https://cdn.krnl.ca/version.txt");

            Console.WriteLine("Current version: ");
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(VersionReturn);
            Console.ResetColor();

            First_Check_Version = VersionReturn;
            Curr_Version = VersionReturn;

            Console.WriteLine("\nChecking for updates every 30 seconds..");
            while (Curr_Version == First_Check_Version)
            {
                Console.Title = "[HamstaGang] | Exploit Update Status | Last check: " + DateTime.Now.ToString("h:mm:ss tt");
                Curr_Version = client.DownloadString("https://cdn.krnl.ca/version.txt");
                Thread.Sleep(30000);
            }

            Console.Clear();
            Console.ForegroundColor = ConsoleColor.Green;
            Console.WriteLine("Exploit has updated! Feel free to now use it!");
            Loop_Beep();
            Console.ReadKey(true);
        }

        private static void ALL_Watch()
        {
            string Curr_Version_KRNL = "";
            string First_Check_Version_KRNL = "";

            string Curr_Version_Synapse = "";
            string First_Check_Version_Synapse = "";

            string Curr_Version_Script = "";
            string First_Check_Version_Script = "";

            Console.Clear();

            string VersionReturn_KRNL = client.DownloadString("https://cdn.krnl.ca/version.txt");
            Console.WriteLine("Current KRNL version: ");
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(VersionReturn_KRNL);
            Console.ResetColor();
            Console.WriteLine("----------------------------------------------------------------------------------------");

            First_Check_Version_KRNL = VersionReturn_KRNL;
            Curr_Version_KRNL = VersionReturn_KRNL;

            string VersionReturn_Synapse = client.DownloadString("https://synapse.to/whitelist/version");
            Console.WriteLine("Current Synapse version: ");
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(VersionReturn_Synapse);
            Console.ResetColor();
            Console.WriteLine("----------------------------------------------------------------------------------------");

            First_Check_Version_Synapse = VersionReturn_Synapse;
            Curr_Version_Synapse = VersionReturn_Synapse;

            string VersionReturn_Scriptware = client.DownloadString("https://script-ware.com/api/version/core");
            Console.WriteLine("Current Script-Ware version: ");
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(VersionReturn_Scriptware);
            Console.ResetColor();
            Console.WriteLine("----------------------------------------------------------------------------------------");

            First_Check_Version_Script = VersionReturn_Scriptware;
            Curr_Version_Script = VersionReturn_Scriptware;

            Console.WriteLine("\nChecking for updates every 30 seconds..");
            while (true)
            {
                Console.Title = "[HamstaGang] | Exploit Update Status | Last check: " + DateTime.Now.ToString("h:mm:ss tt");

                Curr_Version_KRNL = client.DownloadString("https://cdn.krnl.ca/version.txt");
                Curr_Version_Synapse = client.DownloadString("https://synapse.to/whitelist/version");
                Curr_Version_Script = client.DownloadString("https://script-ware.com/api/version/core");

                // We do multiple If statements because we aren't wanting to do elseifs incase one is true
                if (Curr_Version_KRNL != First_Check_Version_KRNL)
                {
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine("KRNL has updated!");
                    Console.ResetColor();
                    SystemSounds.Beep.Play(); // Play beep / windows sound
                }

                if (Curr_Version_Synapse != First_Check_Version_Synapse)
                {
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine("Synapse has updated!");
                    Console.ResetColor();
                    SystemSounds.Beep.Play(); // Play beep / windows sound
                }

                if (Curr_Version_Script != First_Check_Version_Script)
                {
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine("Script-Ware has updated!");
                    Console.ResetColor();
                    SystemSounds.Beep.Play(); // Play beep / windows sound
                }

                // Sleep for 30 seconds
                Thread.Sleep(30000);
            }
        }
    }
}
